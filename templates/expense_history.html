{% extends "layout.html" %} {% block title %}Expense History{% endblock %} {%
block content %}
<div class="container mt-4">
  <h2 class="mb-4 text-center">Expense History</h2>

  <!-- Filter Form -->
  <form class="row g-3 mb-4" method="get">
    <div class="col-md-3">
      <select name="category" class="form-select">
        <option value="">All Categories</option>
        {% for cat in categories %}
        <option
          value="{{ cat }}"
          {%
          if
          cat=""
          ="current_category"
          %}selected{%
          endif
          %}
        >
          {{ cat }}
        </option>
        {% endfor %}
      </select>
    </div>
    <div class="col-md-3">
      <input
        type="date"
        name="start_date"
        value="{{ start_date }}"
        class="form-control"
        placeholder="Start Date"
      />
    </div>
    <div class="col-md-3">
      <input
        type="date"
        name="end_date"
        value="{{ end_date }}"
        class="form-control"
        placeholder="End Date"
      />
    </div>
    <div class="col-md-3">
      <button type="submit" class="btn btn-primary w-100">Filter</button>
    </div>
  </form>

  {% if expenses %}
  <table class="table table-striped table-hover">
    <thead class="table-dark">
      <tr>
        <th>Date</th>
        <th>Category</th>
        <th>Amount</th>
        <th>Note</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      {% for expense in expenses %}
      <tr>
        <td>{{ expense.date }}</td>
        <td>{{ expense.category }}</td>
        <td>{{ expense.amount|usd }}</td>
        <td>{{ expense.note or '-' }}</td>
        <td>
          <a
            href="{{ url_for('expenses.edit_expense', expense_id=expense.id) }}"
            class="btn btn-sm btn-warning"
            >Edit</a
          >
          <a
            href="{{ url_for('expenses.delete_expense', expense_id=expense.id) }}"
            class="btn btn-sm btn-danger"
            onclick="return confirm('Are you sure?');"
            >Delete</a
          >
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>

  <!-- Pagination -->
  <nav aria-label="Page navigation">
    <ul class="pagination justify-content-center">
      {% for p in range(1, total_pages + 1) %}
      <li class="page-item {% if p == page %}active{% endif %}">
        <a
          class="page-link"
          href="?page={{ p }}&category={{ current_category }}&start_date={{ start_date }}&end_date={{ end_date }}"
          >{{ p }}</a
        >
      </li>
      {% endfor %}
    </ul>
  </nav>
  {% else %}
  <p class="text-center">No expenses found.</p>
  {% endif %}
</div>
{% endblock %}
